function getCookie(e){var i=document.cookie.indexOf(e+"="),a=i+e.length+1;if(!i&&e!=document.cookie.substring(0,e.length))return null;if(-1==i)return null;var t=document.cookie.indexOf(";",a);return-1==t&&(t=document.cookie.length),unescape(document.cookie.substring(a,t))}function setCookie(e,i){var a=new Date;a.setTime(a.getTime());var t=28;t=1e3*t*60*60*24;var r=new Date(a.getTime()+t);document.cookie=e+"="+escape(i)+(t?";expires="+r.toGMTString():"")}function selectStyleSheet(){$(active_stylesheet).disabled=!0,active_stylesheet=$("style-selector").value,$(active_stylesheet).disabled=!1}function $(e){return document.getElementById(e)}function addEvent(e,i,a){if(e.addEventListener)return e.addEventListener(i,a,!1),!0;if(e.attachEvent){var t=e.attachEvent("on"+i,a);return t}e["on"+i]=a}function removeEvent(e,i,a){if(e.removeEventListener)return e.removeEventListener(i,a,!1),!0;if(e.detachEvent){var t=e.detachEvent("on"+i,a);return t}e["on"+i]=""}function findTarget(e){var i;if(!e)var e=window.event;return e.target?i=e.target:e.srcElement&&(i=e.srcElement),3==i.nodeType&&(i=i.parentNode),i}function hex2num(e){"#"==e.charAt(0)&&(e=e.slice(1)),e=e.toUpperCase();for(var i,a,t="0123456789ABCDEF",r=new Array(3),n=0,c=0;6>c;c+=2)i=t.indexOf(e.charAt(c)),a=t.indexOf(e.charAt(c+1)),r[n]=16*i+a,n++;return r}function num2hex(e){for(var i,a,t="0123456789ABCDEF",r="#",n=0;3>n;n++)i=e[n]/16,a=e[n]%16,r+=t.charAt(i)+t.charAt(a);return r}function fadeColor(e,i,a,t,r,n){t||(t=20),r||(r=100),i||(i="#FFFFFF"),a||(a="#000000"),n||(n="c");var c=document.getElementById(e);if(c){for(var o=hex2num(i),d=hex2num(a),s=0;3>s;s++)o[s]=Number(o[s]),d[s]=Number(d[s]);for(var s=0;3>s;s++)o[s]<d[s]?(o[s]+=t,o[s]>d[s]&&(o[s]=d[s])):o[s]>d[s]&&(o[s]-=t,o[s]<d[s]&&(o[s]=d[s]));var l="rgb("+o[0]+","+o[1]+","+o[2]+")";"b"==n?c.style.backgroundColor=l:c.style.color=l,(o[0]!=d[0]||o[1]!=d[1]||o[2]!=d[2])&&(i=num2hex(o),window.setTimeout("fadeColor('"+e+"','"+i+"','"+a+"',"+t+","+r+",'"+n+"')",r))}}function getIndex(e,i){var a=3*i+e-3;return a}function getXY(e){var i=1,a=1;switch(e){case 1:a=1,i=1;break;case 2:a=1,i=2;break;case 3:a=1,i=3;break;case 4:a=2,i=1;break;case 5:a=2,i=2;break;case 6:a=2,i=3;break;case 7:a=3,i=1;break;case 8:a=3,i=2;break;case 9:a=3,i=3}return Array(i,a)}function rand(){for(var e=Math.round(10*Math.random());1>e||e>9;)e=Math.round(10*Math.random());return e}function uniqueRand(e){for(var i=rand(),a=0;a<e.length;a++)e[a]==i&&(i=rand(),a=-1);return i}function show(e,i){document.getElementById("display_area").innerHTML=e+"<br />\n",document.getElementById("display_area").style.color=i}function helpLineV(e){var i=document.getElementById("lv-"+e).style;"absolute"==i.position?(i.position="relative",i.height="10px"):(i.position="absolute",i.height=vertical_line_height+"px")}function helpLineH(e){var i=document.getElementById("lh-"+e).style;"absolute"==i.position?(i.position="relative",i.width="5px"):(i.position="absolute",i.width=horizondal_line_width+"px")}function isHorizondal(e,i){return(1==e||2==e||3==e)&(1==i||2==i||3==i)?!0:(4==e||5==e||6==e)&(4==i||5==i||6==i)?!0:(7==e||8==e||9==e)&(7==i||8==i||9==i)?!0:!1}function isVertical(e,i){return(1==e||4==e||7==e)&(1==i||4==i||7==i)?!0:(2==e||5==e||8==e)&(2==i||5==i||8==i)?!0:(3==e||6==e||9==e)&(3==i||6==i||9==i)?!0:!1}function checkForUnique(e,i,a){e++,i++;var t=cells[e-1][i-1].value;if(e>1||a){var r=new Array;switch(e){case 1:a&&r.push(2,3,4,7);break;case 2:r.push(1),a&&r.push(3,5,8);break;case 3:r.push(1,2),a&&r.push(6,9);break;case 4:r.push(1),a&&r.push(5,6,7);break;case 5:r.push(2,4),a&&r.push(6,8);break;case 6:r.push(3,4,5),a&&r.push(9);break;case 7:r.push(1,4),a&&r.push(8,9);break;case 8:r.push(2,5,7),a&&r.push(9);break;case 9:r.push(3,6,7,8)}var n,c,o="";e:for(var d=0;d<r.length;d++){n=getXY(i);for(var s=r[d],l=1;3>=l;l++)if(isHorizondal(e,s)){if(!a){if(1==e||4==e||7==e)continue e;if(5==e&&6==s)continue e;if(8==e&&9==s)continue e}if(c=getIndex(l,n[1]),o=cells[s-1][c-1].value,o==t)return repeated_at="c"+s+c,!1}else{if(!a){if(4>e)continue;if(4==e&&7==s)continue e;if(5==e&&8==s)continue e;if(6==e&&9==s)continue e}if(c=getIndex(n[0],l),o=cells[s-1][c-1].value,o==t)return repeated_at="c"+s+c,!1}}}for(var f=0;9>f;f++){var u=cells[e-1][f].value;if(t==u&&f+1!=i)return repeated_at="c"+e+(f+1),!1}return!0}function insert(e,i){var a=document.getElementById(e);a.style.color="",a.value=i,a.disabled=i?!0:!1}function clearer(){document.f.reset();for(var e=0;9>e;e++)for(var i=0;9>i;i++)cells[e][i].disabled=!1}function discolorCells(e,i){document.getElementById(e).style.background="#fff",i&&(document.getElementById(i).style.background="#fff")}function recordPosition(){for(var e=0,i=0;9>i;i++)for(var a=0;9>a;a++)e=cells[i][a].value,xy[i][a]=isNaN(e)||1!=e.length?0:e}function pos2str(e){var i="",a=0,t=" abcdefghijklmnopqrstuvwxyz";e&&recordPosition();for(var r=0;9>r;r++)for(var n=0;9>n;n++)xy[r][n]?(a&&(i+=t.charAt(a),a=0),i+=xy[r][n]):a++;return i}function str2pos(e){var i=0,a="abcdefghijklmnopqrstuvwxyz",t=0,r=0,n=0;for(e=e.replace(/\./g,"");9>r;)ch=e.charAt(t),id="c"+(r+1)+(n+1),isNaN(ch)||i?i?(insert(id,""),i--):(insert(id,""),i=a.indexOf(ch)):insert(id,ch),i||t++,n++,n>=9&&(n=0,r++)}function makeCookieString(){for(var e="",i=new Array(0),a=0;9>a;a++)for(var t=0;9>t;t++)value=cells[a][t].value,cells[a][t].disabled&&(value="."+value),i.push(value);return e=i.join(";")}function checkCell(e){var i=findTarget(e),a=i.value;if(1>a||a>9||isNaN(a))return tagProblemCell(i,1),a.length>1&&(i.className+=" possibilities-entry"),0;if(i.className.indexOf("possibilities-entry")&&(i.className=i.className.replace(/ possibilities\-entry/g,""),i.className=i.className.replace(/ problem\-cell/g,""),i.style.color="#000"),$("live-hints").checked){var t=i.id,r=Number(t.charAt(1))-1,n=Number(t.charAt(2))-1;if(!checkForUnique(r,n,!0))return i.style.background="red",$(repeated_at).style.background="red",setTimeout("discolorCells('"+repeated_at+"','"+t+"')",2e3),0}return tagProblemCell(i,0),1}function makeProblemCell(e){$(e).className+=" problem-cell"}function tagProblemCell(e,i){var a=e.className.toString(),t=0;a.indexOf("problem-cell")>=0&&(t=1),i?t||(e.className+=" problem-cell"):t&&(e.className=a.replace(" problem-cell",""))}function save(){var e=makeCookieString();setCookie("sudoku_fingerprint",e),alert("Game saved.")}function load(){clearer();var e=getCookie("sudoku_fingerprint");if(""==e||null==e)return alert("No saved games found!"),!1;compleated=0;for(var i=0,a=e.split(";"),t=0;9>t;t++)for(var r=0;9>r;r++)number=a[i],"."==number.charAt(0)&&(number=number.charAt(1),cells[t][r].disabled=!0),cells[t][r].value=number,i++}function timer(){timer_seconds||(timer_seconds=0),timer_seconds++;{var e=timer_seconds%1e4;Math.floor(timer_seconds/60)}0>e&&(e="0"+e),timer_element.innerHTML=e,timer_clock=window.setTimeout("timer()",1e3)}function stopTimer(){timer_clock&&clearTimeout(timer_clock)}function toggleTimer(){if(timer_paused){$("timer_control").value="Pause",timer_element.style.color="#000",timer_paused=0,timer();var e=$("pause-hider");e.style.display="none"}else{clearTimeout(timer_clock),timer_element.style.color="#f00",$("timer_control").value="Continue",timer_paused=1;var e=$("pause-hider");e.style.display="block",timer_seconds||(timer_seconds=0);var i=timer_seconds%60,a=Math.floor(timer_seconds/60);10>i&&(i="0"+i),10>a&&(a="0"+a),e.innerHTML="<br /><strong>Game Paused at "+a+":"+i+"</strong><br /><br /><a onclick='toggleTimer()' style='cursor:hand;'>Click to Continue...</a>"}}function checker(){var e=0;show("Checking game...","#a84efa");e:for(var i=0;9>i;i++)for(var a=0;9>a;a++){var t=cells[i][a],r="c"+(i+1)+(a+1),n=t.value;if(isNaN(n)||1>n||n>9){""==n?show("Empty cells found.","#d78601"):show("Invalid entries found.","#d78601"),e=1,t.style.background="red",setTimeout("discolorCells('"+r+"')",2e3);break e}if(!n){show("Empty cells were found. Please complete the puzzle.","#d78601"),t.style.background="red",setTimeout("discolorCells('"+r+"')",2e3),e=1;break e}if(!checkForUnique(i,a,!1)){t.style.background="red",document.getElementById(repeated_at).style.background="red",show("Repeated numbers were found.","#d78601"),setTimeout("discolorCells('"+repeated_at+"','"+r+"')",2e3),e++;break e}}e||(alert(compleated?"Sorry - you can't win after giving up. But it is solved.":"Congratulations - You have completed the puzzle."),stopTimer(),show("Game Over","#000000"))}function reloadGame(){str2pos(orginal_game)}function solve(){show("Finding the solution to the game..."),confirm("This will automaticaly solve the puzzle for you.\nAre you sure you want to do this?\n")&&(str2pos(this_puzzle),compleated=1,show("Solved the puzzle."),stopTimer())}function checkStatus(){for(var e=0,i=0,a=0;9>a;a++)for(var t=0;9>t;t++){var r=cells[a][t],n=r.value;if(isNaN(n)||1>n||n>9)""==n?i++:e++;else if(n){if(!checkForUnique(a,t,!0)){r.style.background="red";var c="c"+(a+1)+(t+1);return $(repeated_at).style.background="red",void setTimeout("discolorCells('"+repeated_at+"','"+c+"')",2e3)}}else i++}show("You are doing fine so far. You have "+(e+i)+" more cells to fill.","#006600"),fadeColor("display_area","#ffff00","#ffffff",30,100,"b")}function putSelectedDigit(e){var i=findTarget(e);i.value=pen_selected_digit,checkCell(),i.blur()}function monitorKeyboard(e){if(!e)var e=window.event;e.keyCode?code=e.keyCode:e.which&&(code=e.which);var i=String.fromCharCode(code);if(!isNaN(i)){var a=Number(i);a&&pickPenDigit(a)}}function pickPen(){for(var e=0;9>e;e++)for(var i=0;9>i;i++){var a=cells[e][i];-1==a.className.indexOf("pen-picked")&&(a.className+=" pen-picked"),addEvent(a,"click",putSelectedDigit)}addEvent(document,"keypress",monitorKeyboard),$("pen-picks").style.display="inline"}function downPen(){for(var e=0;9>e;e++)for(var i=0;9>i;i++){var a=cells[e][i];if(a.className){var t=a.className.toString();a.className=t.replace(/pen\-picked/g,"")}removeEvent(a,"click",putSelectedDigit)}removeEvent(document,"keypress",monitorKeyboard),$("pen-picks").style.display="none"}function pickPenDigit(e){pen_selected_digit=e,$("selected-pen-number").firstChild.nodeValue=e}function cellClicked(e){selected_cell=findTarget(e)}function revealCell(){if(selected_cell){var e=this_puzzle.replace(/\./g,""),i=selected_cell.id.split(""),a=i[1]-1,t=i[2]-1,r=e.substr(9*a),n=r.charAt(t);selected_cell.value=n,fadeColor(selected_cell.id,"#ffffff","#000000",10,100,"c")}}function makeNewOrder(e){var a=" abcdefghijklmnopqrstuvwxyz",t="";for(numbers=new Array("0"),j=0;9>j;j++)new_numbers=uniqueRand(numbers),numbers.push(new_numbers);for(i=0;i<e.length;i++)t+="."==e.charAt(i)||"*"==e.charAt(i)||"x"==e.charAt(i)||"_"==e.charAt(i)||"-"==e.charAt(i)||"+"==e.charAt(i)?".":numbers[a.indexOf(e.charAt(i))];return t}function newGame(){chosen=Math.floor(10*Math.random()/(10/puzzles.length)),this_puzzle=makeNewOrder(puzzles[chosen]),show(""),compleated=0,clearer();var e=0,i=0;default_number_per_box=$("difficulty").value;for(var a=0;9>a;a++){for(var t=0,r=0,n=new Array,c=9,o="",d=0,s=e;e+c>s;s++)"."==this_puzzle.charAt(s)&&(c++,d++),o+=this_puzzle.charAt(s);for(e+=c,number_of_numbers=default_number_per_box-i,i=0,d>number_of_numbers&&(rand()>5&&(i=d-number_of_numbers),number_of_numbers=d),n=new Array,t=0;number_of_numbers>t;t++)r=o.indexOf("."),r+1?o=o.substring(0,r)+o.substring(r+1,o.length):(r=uniqueRand(n),r--),n.push(r+1),insertion_number=o.charAt(r),r++,id="c"+(a+1)+r,insert(id,insertion_number)}orginal_game=pos2str(2),stopTimer(),timer_seconds=0,$("timer").innerHTML="00:00",timer(),timer_started=1}function init(){for(var e,i=1;9>=i;i++)for(var a=1;9>=a;a++)e=document.getElementById("c"+i+a),addEvent(e,"change",checkCell),addEvent(e,"click",cellClicked),cells[i-1][a-1]=e;var t=getCookie("sudoku_options_stylesheet");$(t)&&($(active_stylesheet).disabled=!0,active_stylesheet=t,$(active_stylesheet).disabled=!1,$("style-selector").value=t);var r=getCookie("sudoku_options_live_hint");r&&($("live-hints").checked=r),timer_element=$("timer"),newGame()}function exit(){setCookie("sudoku_options_stylesheet",active_stylesheet),$("live-hints").checked?setCookie("sudoku_options_live_hint",!0):setCookie("sudoku_options_live_hint",!1)}for(var debug=0,horizondal_line_width=350,vertical_line_height=370,default_number_per_box=4,repeated_at="",compleated=0,active_stylesheet="classic-style",selected_cell,timer_started=0,timer_clock,timer_element,timer_seconds=0,timer_paused=0,xy=new Array(9),i=0;9>i;i++)xy[i]=new Array(9);for(var cells=new Array(9),i=0;9>i;i++)cells[i]=new Array(9);var puzzles=new Array("abc.gdefihdeif.hagcbfgh.cibade.bf.iehdcg.ae.acbf.gid.hghdiace.bficgdabhefh.b.f.cg.eaidde.ahfibcg","a.bfhiec.g.ddcg.fbai.heiehdg.cabfdegi.hc.fabai.cb.df.eghhf.be.agcidbfi.edhgcac.adgf.iheb.g.hebcaf.di","bfi.edhgcac.adgf.iheb.g.hebcaf.dia.b.fhiec.g.ddcg.fbai.heiehdg.cabfdegi.hc.fabai.cb.df.eghhf.be.agcid","ib.ad.c.g.efhe.hc.fbiagd.fg.daehcibbhcgd.faiegf.ei.ab.dchdai.hcebfgfgdcai.he.bbeahd.gc.ifih.c.e.bf.gda","aeh.dfi.cgbcf.b.e.hgiad.gidc.abfeh.fc.g.b.aeihdb.eifdha.gchda.ig.cebfg.bfhd.aeic.dcegi.f.hbaah.ibce.dfg","dah.iegfcbbigfd.cehae.fchab.gi.dbh.fe.gacidcedi.bhgaf.ag.i.d.cfbh.egb.ch.dea.f.ihf.e.aci.d.gbid.a.fbgceh","cf.b.ag.eidhhd.eif.cbaga.g.ibdh.fceg.acb.ifhe.d.dehgcafb.i.ifbe.hdg.acdc.iebg.f.haegf.ahd.cibhba.ci.f.deg","chfgeai.d.be.gdib.hcf.ab.iacf.dh.gefa.d.hcg.ebigic.bd.eahfeb.hfa.i.gdcd.gh.bica.fe.fei.hagd.cb.a.cbdefihg","adbfheig.c.icfba.gdeh.he.gcidfa.bcb.ide.ah.fgag.dh.fbei.cefhigcbd.abi.he.cd.gafg.de.fbach.i.acf.g.hid.b.e","ied.a.bfghchcfgeia.b.dagbh.cdi.efb.ied.ca.f.ghcga.ef.hdib.fd.hbig.cae.hdie.fg.cabb.a.e.ihcf.dggfcd.b.aehi","h.g.bc.ea.idfa.ci.bf.dgehfe.dih.gcbab.fi.ehg.acdh.dcfabi.geag.edc.ib.fhdah.gbe.ficebf.ci.ad.hggi.ch.df.e.ab",".e.cadbhfgi.fbhegiad.cg.di.afch.bei.h.fba.g.cd.e.badhceif.g.ec.g.dif.b.hag.ibhe.da.fc.chagifde.bfedcabi.g.h","ge.c.h.i.fdabaif.bg.d.echdh.bae.cf.gic.he.fbdig.a.dbageifh.c.ifgca.hb.deb.dh.efg.acicf.e.ia.bhdggia.h.c.d.ebf","deb.cg.a.ihff.ah.dbi.egccgi.h.fe.bda.gcdf.bihae.a.fb.hd.ec.i.geihg.acfb.dbi.ca.d.hefgge.dbc.fi.haah.f.ie.gdcb"),chosen=0,this_puzzle="",orginal_game="",sudoku_fingerprint=getCookie("sudoku_fingerprint");(null==sudoku_fingerprint||""==sudoku_fingerprint)&&(sudoku_fingerprint="");var pen_selected_digit=1;window.onload=init,window.onunload=exit;
